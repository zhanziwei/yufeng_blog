---
layout: post
title: 计算机网络分层
date: 2021-04-19
Author: yufeng 
tags: [计网]
comments: true
toc: true
---

## 计算机网络要点

#### 为什么要分层

 网络协议设计者不应当设计一个单一、巨大的协议来为所有形式的通信规定完整的细节，而应把通信问题划分成多个小问题，然后为每一个小问题设计一个单独的协议。这样做使得每个协议的设计、分析、时限和测试比较容易。协议划分的一个主要原则是确保目标系统有效且效率高。

1. 为了提高效率，每个协议只应该注意没有被其他协议处理过的那部分通信问题
2. 为了主协议的实现更加有效，协议之间共享特定的数据结构
3. 这些协议的组合能够处理所有可能的硬件错误以及其他异常情况
4. 为了保证协同性，应当将协议设计和开发成完整的、协作的协议系列，而不是鼓励地开发每个协议。

一台计算机操作系统中的网络过程包括从应用请求(在协议栈的顶部)到网络介质(底部) ，OSI参考模型把功能分成七个分立的层次。

#### OSI网络分层模型

![img](https://upload-images.jianshu.io/upload_images/6908438-5c9dbe277be5e918.jpg?imageMogr2/auto-orient/strip|imageView2/2/w/432/format/webp)

* 第一层：物理层（physical）（单位类型：比特）：实现比特流的透明传输，物理接口，具有电气特性
* 第二层：数据链路层（date link）（单位类型：帧）：访问介质；数据在该层封装成帧；用MAC地址作为访问媒介；具有错误检测与修正功能。
* 第三层:网络层（network）（单位类型：数据包、分组）：数据传输；提供逻辑地址，选择路由数据包，负责在源和终点之间建立连接
* 第四层：传输层（transport）（单位类型：数据段）:实现端到端传输；分可靠与不可靠传输；在传输前实现错误检测与流量控制，定义端口号（标记相应的服务）
* 第五层：会话层（session）：主机间通信；对应用会话管理，同步
* 第六层：表示层（presention）：数据表现形式；特定功能的实现-比如加密模式确保原始设备上加密的数据可以在目标设备上正确地解密
* 第七层：应用层（application）（单位类型：报文）：最接近终端用户的OSI层，这就意味着OSI应用层与用户之间是通过应用软件直接相互作用的。网络进程访问应用层；提供接口服务

#### TCP/IP分层模型

* 物理层：用物理手段将电脑连接起来，就像我们上边讲到的计算机之间的物理连线。
* 数据链路层：在数据链路层规定一套协议，专门的给0、1信号进行分组，以及规定不同的组代表什么意思，从而双方计算机都能够进行识别，这个协议就是“以太网协议”
* 网络层：通过 IP 地址来判断两个计算机设备是否在同一子网络中的，建立连接，IP协议
* 传输层：实现“端口到端口”的通信。计算机上运行的不同程序都会分配不同的端口，所以才能使得数据能够正确的传送给不同的应用程序。TCP/UDP协议
* 应用层：规定了应用程序的数据格式。HTTP/FTP/DNS协议

#### 数据链路层

数据链路层是把网络层交下来的IP数据报封装成帧，以及把帧种的数据取出上交给网络层。

要解决三个基本问题：封装成帧、透明传输和差错检测。

使用以太网协议来规定电信号的分组形式

![img](https://pic1.zhimg.com/80/v2-fb8534d86e40986e43449de6c35ebd14_720w.jpg)

![img](https://img-blog.csdn.net/20180506181547637?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2hocGluZ3llYXI=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70)

广播的过程：

我们开始发送数据，将发送方的 MAC 地址和接收方的 MAC 地址封装在数据包中，然后发送端向同一子网络中（同一局域网）中的所有计算机发送该数据包，所有的计算机接收到该包之后，就对数据包的头部进行提取，提取出里边封装好的接收端 MAC 地址和自己的 MAC 地址作比对，如果相同，就说明该数据包是给自己发送的，否则，就会丢弃该数据包。

#### 网络层

网络层包括IP协议和ARP协议，通过ARP协议解析出MAC地址。ARP 协议发出一个数据包，包含在以太网的数据包中（其中包含对方的 IP 地址，对方的 MAC 地址栏是 FF:FF:FF:FF:FF:FF）。子网络中的每台主机都会收到这个包，然后从中取出 IP 地址与自身对比，如果两者相同，都做出回复，向对方报告自己的 MAC 地址，否则就丢弃这个包。

![img](https://pic4.zhimg.com/80/v2-991572825990575d273f653a78bcc5e7_720w.jpg)

![IP协议及IP数据包详解_蜜蜂采蜜-CSDN博客_ip数据包](https://img-blog.csdn.net/20170516161649348)

IP协议中最重要的是判断两个设备是否属于同一子网中，将两个IP地址与子网掩码分别进行AND运算，然后比较结果是否相同，只有相同才是在同一个子网络中。

#### 传输层

传输层是用来确定端口到端口的通信，涉及到TCP和UDP协议。

![img](https://pic2.zhimg.com/80/v2-31bff54e0720487afe37e5f3f282d231_720w.jpg)



#### 应用层

![img](https://pic2.zhimg.com/80/v2-741e4cd7f95897d6a61bd219e208f1c1_720w.jpg)

